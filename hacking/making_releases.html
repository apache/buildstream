

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Making releases &mdash; BuildStream 2.6.0+8.g80d16dee4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=df3801b4"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generating protocol buffers" href="grpc_protocols.html" />
    <link rel="prev" title="Measuring performance" href="measuring_performance.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            BuildStream
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../main_about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main_install.html">Installing from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main_using.html">Using</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main_core.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main_porting.html">Porting guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../CONTRIBUTING.html">Contributing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../CONTRIBUTING.html#filing-issues">Filing issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CONTRIBUTING.html#fixing-bugs">Fixing bugs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CONTRIBUTING.html#adding-new-features">Adding new features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CONTRIBUTING.html#submitting-patches">Submitting patches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CONTRIBUTING.html#committer-access">Committer access</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CONTRIBUTING.html#windows-ci">Windows CI</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../CONTRIBUTING.html#further-information">Further information</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="coding_guidelines.html">Coding guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="using_the_testsuite.html">Using the test suite</a></li>
<li class="toctree-l3"><a class="reference internal" href="writing_documentation.html">Writing documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="writing_plugins.html">Adding core plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="measuring_performance.html">Measuring performance</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Making releases</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pre-release-changes">Pre-release changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#release-process">Release process</a></li>
<li class="toctree-l4"><a class="reference internal" href="#post-release-activities">Post-release activities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="grpc_protocols.html">Generating protocol buffers</a></li>
<li class="toctree-l3"><a class="reference internal" href="managing_data_files.html">Managing data files</a></li>
<li class="toctree-l3"><a class="reference internal" href="updating_python_deps.html">Updating BuildStream’s Python dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="updating_python_deps.html#adding-support-for-a-new-python-release">Adding support for a new Python release</a></li>
<li class="toctree-l3"><a class="reference internal" href="updating_python_deps.html#removing-support-for-a-python-release">Removing support for a Python release</a></li>
<li class="toctree-l3"><a class="reference internal" href="updating_python_deps.html#abi-compatibility-for-binary-python-packages">ABI compatibility for binary Python packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="ui.html">Contributing to the UI</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../main_architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main_glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BuildStream</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../CONTRIBUTING.html">Contributing</a></li>
      <li class="breadcrumb-item active">Making releases</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/hacking/making_releases.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="making-releases">
<span id="id1"></span><h1>Making releases<a class="headerlink" href="#making-releases" title="Link to this heading"></a></h1>
<p>This is a checklist of activities which must be observed when creating
BuildStream releases, it is important to keep this section up to date
whenever the release process changes.</p>
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading"></a></h2>
<p>There are a couple of requirements and accounts required in order
to publish a release.</p>
<ul class="simple">
<li><p>Ability to send email to <code class="docutils literal notranslate"><span class="pre">dev&#64;buildstream.apache.org</span></code>.</p></li>
<li><p>Shell account at <code class="docutils literal notranslate"><span class="pre">master.gnome.org</span></code>.</p></li>
<li><p>Access to the <a class="reference external" href="https://pypi.org/project/BuildStream/">BuildStream project on PyPI</a></p></li>
<li><p>An email client which still knows how to send emails in plain text.</p></li>
</ul>
</section>
<section id="pre-release-changes">
<h2>Pre-release changes<a class="headerlink" href="#pre-release-changes" title="Link to this heading"></a></h2>
<p>Before actually rolling the release, here is a list of changes which
might need to be done in preparation of the release.</p>
<ul>
<li><p>Ensure that the man pages are up to date</p>
<p>The man pages are committed to the repository because we are
currently unable to integrate this generation into the setuptools
build phase, as outlined in issue #8.</p>
<p>If any of the user facing CLI has changed, or if any of the
related docstrings have changed, then you should
<a class="reference internal" href="writing_documentation.html#contributing-man-pages"><span class="std std-ref">regenerate the man pages</span></a> and
add/commit the results before wrapping a release.</p>
</li>
<li><p>Ensure the documentation session HTML is up to date</p>
<p>The session HTML files are committed to the repository for multiple
reasons, one of them being that the documentation must be buildable
from within a release build environment so that downstream distribution
packagers can easily create the docs package.</p>
<p>This is currently only needed for the first stable release
in a stable line of releases, after this point the API is frozen
and will not change for the remainder of the stable release lifetime,
so nothing interesting will have changed in these session files.</p>
<p>If regeneration is needed, follow <a class="reference internal" href="writing_documentation.html#contributing-session-html"><span class="std std-ref">the instructions above</span></a>.</p>
</li>
<li><p>Ensure the NEWS entry is up to date and ready</p>
<p>For a stable release where features have not been added, we
should at least add some entries about the issues which have
been fixed since the last stable release.</p>
<p>For development releases, it is worthwhile going over the
existing entries and ensuring all the major feature additions
are mentioned and there are no redundancies.</p>
</li>
<li><p>Push pre-release changes</p>
<p>Now that any final pre-release changes to generated files or NEWS have
been made, push these directly to the upstream repository.</p>
<p>Do not sit around waiting for CI or approval, these superficial changes
do not affect CI and you are intended to push these changes directly
to the upstream repository.</p>
</li>
</ul>
</section>
<section id="release-process">
<h2>Release process<a class="headerlink" href="#release-process" title="Link to this heading"></a></h2>
<ul>
<li><p>Ensure that the latest commit is passing in CI</p>
<p>Of course, we do not release software which does not pass it’s own
tests.</p>
</li>
<li><p>Get the list of contributors</p>
<p>The list of contributors for a given list is a list of
any contributors who have landed any patches since the
last release.</p>
<p>An easy way to get this list is to ask git to summarize
the authors of commits since the <em>last release tag</em>. For
example, if we are about to create the <code class="docutils literal notranslate"><span class="pre">1.1.1</span></code> release, then
we need to observe all of the commits since the <code class="docutils literal notranslate"><span class="pre">1.1.0</span></code>
release:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>shortlog<span class="w"> </span>-s<span class="w"> </span><span class="m">1</span>.1.0...@
</pre></div>
</div>
<p>At times, the same contributor might make contributions from different
machines which they have setup their author names differently, you
can see that some of the authors are actually duplicates, then
remove the duplicates.</p>
</li>
<li><p>Start composing the release announcement email</p>
<p>The first thing to do when composing the release email is to
ensure your mail client has disabled any HTML formatting and will
safely use plain text only.</p>
<p>Try to make the release announcement consistent with other release
announcements as much as possible, an example of the email
can be <a class="reference external" href="https://mail.gnome.org/archives/buildstream-list/2019-February/msg00039.html">found here</a>.</p>
<p>The recipient of the email is <code class="docutils literal notranslate"><span class="pre">dev&#64;buildstream.apache.org</span></code> and the title
of the email should be of the form: <code class="docutils literal notranslate"><span class="pre">BuildStream</span> <span class="pre">1.1.1</span> <span class="pre">released</span></code>, without
any exclamation point.</p>
<p>The format of the email is essentially:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Hi all,

This is the personalized message written to you about this
release.

If this is an unstable release, this should include a warning
to this effect and an invitation to users to please help us
test this release.

This is also a good place to highlight specific bug fixes which
users may have been waiting for, or highlight a new feature we
want users to try out.


What is BuildStream ?
=====================
This is a concise blurb which describes BuildStream in a couple of
sentences, and is taken from the the README.rst.

The easiest thing is to just copy this over from the last release email.


=================
buildstream 1.1.1
=================
This section is directly copy pasted from the top of the NEWS file


Contributors
============
 - This is Where
 - You Put
 - The Contributor
 - Names Which
 - You Extracted
 - Using git shortlog -s


Where can I get it ?
====================
https://download.gnome.org/sources/BuildStream/1.1/

For more information on the BuildStream project, visit our home page
at https://buildstream.build/
</pre></div>
</div>
</li>
<li><p>Publish the release tag</p>
<p>Now that any pre-release changes are upstream, create and push the
signed release tag like so:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>tag<span class="w"> </span>-s<span class="w"> </span><span class="m">1</span>.1.1
git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span><span class="m">1</span>.1.1
</pre></div>
</div>
<p>This will trigger the “Release actions” workflow which also takes care of:</p>
<blockquote>
<div><ul class="simple">
<li><p>uploading Github release artifacts</p></li>
<li><p>uploading Python source and binary packages to PyPI</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Upload the release tarball</p>
<p>First get yourself into a clean repository state, ensure that you
don’t have any unfinished work or precious, uncommitted files lying
around in your checkout and then run:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clean<span class="w"> </span>-xdff
</pre></div>
</div>
<p>Create the tarball with the following command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>setup.py<span class="w"> </span>sdist
</pre></div>
</div>
<p>And upload the resulting tarball to the master GNOME server:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>scp<span class="w"> </span>dist/BuildStream-1.1.1.tar.gz<span class="w"> </span>&lt;user&gt;@master.gnome.org:
</pre></div>
</div>
<p>And finally login to your account at <code class="docutils literal notranslate"><span class="pre">master.gnome.org</span></code> and run
the install scripts to publish the tarball and update the mirrors:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ftpadmin<span class="w"> </span>install<span class="w"> </span>BuildStream-1.1.1.tar.gz
</pre></div>
</div>
</li>
<li><p>Send the release email</p>
<p>Now that the release tag is up and the tarball is published,
you can send the release email.</p>
</li>
</ul>
</section>
<section id="post-release-activities">
<h2>Post-release activities<a class="headerlink" href="#post-release-activities" title="Link to this heading"></a></h2>
<p>Once the release has been published, there are some activities
which need to be done to ensure everything is up to date.</p>
<ul>
<li><p>Check that the release was successfully uploaded to PyPI. If
it is an unstable release, make sure the version on PyPI has
the correct “dev0” postfix so to avoid being treated as stable.</p></li>
<li><p>Update the topic line in the #buildstream IRC channel if needed</p>
<p>The IRC channel usually advertizes the latest stable release
in the topic line, now is the right time to update it.</p>
</li>
<li><p>Update the website repository</p>
<p>The website wants to link to release announcements, but this
cannot be automated because we cannot guess what the link to
the release email will be in the mailing list archive.</p>
<p>Find the URL to the announcement you just published
<a class="reference external" href="https://lists.apache.org/list.html?dev&#64;buildstream.apache.org/">in the mailing list archives</a>,
and use that URL to update the <code class="docutils literal notranslate"><span class="pre">anouncements.json</span></code> file in the website
repository.</p>
<p>Commit and push this change to the the <code class="docutils literal notranslate"><span class="pre">anouncements.json</span></code> file to
the upstream website repository, and gitlab will take care of automatically
updating the website accordingly.</p>
</li>
<li><p>Regenerate BuildStream documentation</p>
<p>In order to update the badges we use in various documentation
which reflects what is the latest stable releases and the latest
development snapshots, we simply need to ensure a pipeline runs
for the master branch in the BuildStream repository.</p>
<p>You can do this by using the “Run Pipeline” feature on the
<a class="reference external" href="https://gitlab.com/BuildStream/buildstream/pipelines">pipelines page in the gitlab UI</a>.</p>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="measuring_performance.html" class="btn btn-neutral float-left" title="Measuring performance" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="grpc_protocols.html" class="btn btn-neutral float-right" title="Generating protocol buffers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2022, The Apache Software Foundation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>